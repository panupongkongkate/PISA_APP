@page "/documentation"
@using PISA_APP.Services
@inject AuthenticationService AuthService
@inject NavigationManager Navigation
@inject IJSRuntime JSRuntime
@rendermode InteractiveServer

<PageTitle>เอกสารประกอบระบบ - PISA</PageTitle>

@if (!AuthService.IsAuthenticated)
{
    Navigation.NavigateTo("/login");
    return;
}

@if (!AuthService.IsAdmin())
{
    Navigation.NavigateTo("/401");
    return;
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h1 class="h3">
                        <i class="fas fa-book me-2"></i>
                        เอกสารประกอบระบบ
                    </h1>
                    <p class="text-muted">คู่มือการใช้งานและโครงสร้างระบบข้อสอบออนไลน์ PISA</p>
                </div>
                <div>
                    <button class="btn btn-primary" @onclick="ExportDocumentation">
                        <i class="fas fa-download me-2"></i>
                        Export PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <ul class="nav nav-tabs mb-4" id="docTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="database-tab" data-bs-toggle="tab" data-bs-target="#database-design" type="button" role="tab">
                <i class="fas fa-database me-2"></i>Database Schema
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="api-tab" data-bs-toggle="tab" data-bs-target="#api-design" type="button" role="tab">
                <i class="fas fa-code me-2"></i>API Design
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="structure-tab" data-bs-toggle="tab" data-bs-target="#project-structure" type="button" role="tab">
                <i class="fas fa-folder-tree me-2"></i>Project Structure
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="guide-tab" data-bs-toggle="tab" data-bs-target="#user-guide" type="button" role="tab">
                <i class="fas fa-question-circle me-2"></i>User Guide
            </button>
        </li>
    </ul>

    <div class="tab-content" id="docTabsContent">
        <!-- Database Schema Design -->
        <div class="tab-pane fade show active" id="database-design" role="tabpanel">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-database text-primary me-2"></i>
                        Database Schema Design
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted mb-4">โครงสร้างตารางและฟิลด์ในระบบข้อสอบออนไลน์ PISA</p>
                    
                    <!-- Users Table -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card bg-light">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0"><i class="fas fa-table me-2"></i>users (ตารางผู้ใช้งาน)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted small mb-2">เก็บข้อมูลผู้ใช้ระบบทั้งหมด: Admin, Teacher, Student</p>
                                    <table class="table table-sm table-borderless">
                                        <tbody>
                                            <tr><td><code>id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสผู้ใช้ (Primary Key)</td></tr>
                                            <tr><td><code>username</code></td><td><span class="badge bg-info">VARCHAR(50)</span></td><td>ชื่อผู้ใช้สำหรับเข้าสู่ระบบ</td></tr>
                                            <tr><td><code>password</code></td><td><span class="badge bg-info">VARCHAR(255)</span></td><td>รหัสผ่าน (แฮช)</td></tr>
                                            <tr><td><code>full_name</code></td><td><span class="badge bg-info">VARCHAR(200)</span></td><td>ชื่อ-นามสกุลจริง</td></tr>
                                            <tr><td><code>email</code></td><td><span class="badge bg-info">VARCHAR(100)</span></td><td>อีเมลติดต่อ</td></tr>
                                            <tr><td><code>phone</code></td><td><span class="badge bg-info">VARCHAR(20)</span></td><td>เบอร์โทรศัพท์</td></tr>
                                            <tr><td><code>role</code></td><td><span class="badge bg-success">ENUM</span></td><td>บทบาท: Admin/Teacher/Student</td></tr>
                                            <tr><td><code>is_active</code></td><td><span class="badge bg-secondary">BOOLEAN</span></td><td>สถานะการใช้งาน (เปิด/ปิด)</td></tr>
                                            <tr><td><code>created_at</code></td><td><span class="badge bg-dark">DATETIME</span></td><td>วันที่สร้างบัญชี</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card bg-light">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0"><i class="fas fa-table me-2"></i>subjects (ตารางรายวิชา)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted small mb-2">เก็บข้อมูลวิชาเรียนที่เปิดสอนในระบบ</p>
                                    <table class="table table-sm table-borderless">
                                        <tbody>
                                            <tr><td><code>id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสวิชา (Primary Key)</td></tr>
                                            <tr><td><code>name</code></td><td><span class="badge bg-info">VARCHAR(100)</span></td><td>ชื่อวิชาเรียน</td></tr>
                                            <tr><td><code>code</code></td><td><span class="badge bg-info">VARCHAR(20)</span></td><td>รหัสวิชา เช่น MATH101</td></tr>
                                            <tr><td><code>description</code></td><td><span class="badge bg-info">TEXT</span></td><td>คำอธิบายรายวิชา</td></tr>
                                            <tr><td><code>teacher_id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสอาจารย์ผู้สอน (FK→users.id)</td></tr>
                                            <tr><td><code>is_active</code></td><td><span class="badge bg-secondary">BOOLEAN</span></td><td>สถานะการเปิดสอน</td></tr>
                                            <tr><td><code>created_at</code></td><td><span class="badge bg-dark">DATETIME</span></td><td>วันที่สร้างวิชา</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Exams & Questions Tables -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card bg-light">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0"><i class="fas fa-table me-2"></i>exams (ตารางข้อสอบ)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted small mb-2">เก็บข้อมูลข้อสอบที่สร้างโดยอาจารย์</p>
                                    <table class="table table-sm table-borderless">
                                        <tbody>
                                            <tr><td><code>id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสข้อสอบ (Primary Key)</td></tr>
                                            <tr><td><code>subject_id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสวิชา (FK→subjects.id)</td></tr>
                                            <tr><td><code>title</code></td><td><span class="badge bg-info">VARCHAR(200)</span></td><td>ชื่อข้อสอบ</td></tr>
                                            <tr><td><code>description</code></td><td><span class="badge bg-info">TEXT</span></td><td>คำอธิบายข้อสอบ</td></tr>
                                            <tr><td><code>time_limit</code></td><td><span class="badge bg-warning">INT</span></td><td>เวลาทำข้อสอบ (นาที)</td></tr>
                                            <tr><td><code>total_points</code></td><td><span class="badge bg-warning">INT</span></td><td>คะแนนเต็มของข้อสอบ</td></tr>
                                            <tr><td><code>start_date</code></td><td><span class="badge bg-dark">DATETIME</span></td><td>วันเวลาเริ่มเปิดสอบ</td></tr>
                                            <tr><td><code>end_date</code></td><td><span class="badge bg-dark">DATETIME</span></td><td>วันเวลาปิดสอบ</td></tr>
                                            <tr><td><code>is_active</code></td><td><span class="badge bg-secondary">BOOLEAN</span></td><td>สถานะการใช้งานข้อสอบ</td></tr>
                                            <tr><td><code>created_at</code></td><td><span class="badge bg-dark">DATETIME</span></td><td>วันที่สร้างข้อสอบ</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card bg-light">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0"><i class="fas fa-table me-2"></i>questions (ตารางคำถาม)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted small mb-2">เก็บคำถามในแต่ละข้อสอบ</p>
                                    <table class="table table-sm table-borderless">
                                        <tbody>
                                            <tr><td><code>id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสคำถาม (Primary Key)</td></tr>
                                            <tr><td><code>exam_id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสข้อสอบ (FK→exams.id)</td></tr>
                                            <tr><td><code>question_text</code></td><td><span class="badge bg-info">TEXT</span></td><td>ข้อความคำถาม</td></tr>
                                            <tr><td><code>question_type</code></td><td><span class="badge bg-success">ENUM</span></td><td>ประเภท: ปรนัย/อัตนัย</td></tr>
                                            <tr><td><code>options</code></td><td><span class="badge bg-info">JSON</span></td><td>ตัวเลือกคำตอบ (กรณีปรนัย)</td></tr>
                                            <tr><td><code>correct_answer</code></td><td><span class="badge bg-info">TEXT</span></td><td>คำตอบที่ถูกต้อง</td></tr>
                                            <tr><td><code>points</code></td><td><span class="badge bg-warning">INT</span></td><td>คะแนนของคำถามนี้</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Exam Results Table -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card bg-light">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="mb-0"><i class="fas fa-table me-2"></i>exam_results (ตารางผลการสอบ)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted small mb-2">เก็บผลการทำข้อสอบของนักศึกษาแต่ละคน</p>
                                    <table class="table table-sm table-borderless">
                                        <tbody>
                                            <tr><td><code>id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสผลสอบ (Primary Key)</td></tr>
                                            <tr><td><code>student_id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสนักศึกษา (FK→users.id)</td></tr>
                                            <tr><td><code>exam_id</code></td><td><span class="badge bg-warning">INT</span></td><td>รหัสข้อสอบ (FK→exams.id)</td></tr>
                                            <tr><td><code>score</code></td><td><span class="badge bg-warning">INT</span></td><td>คะแนนที่ได้</td></tr>
                                            <tr><td><code>total_points</code></td><td><span class="badge bg-warning">INT</span></td><td>คะแนนเต็ม</td></tr>
                                            <tr><td><code>percentage</code></td><td><span class="badge bg-warning">DECIMAL</span></td><td>เปอร์เซ็นต์คะแนน</td></tr>
                                            <tr><td><code>answers</code></td><td><span class="badge bg-info">JSON</span></td><td>คำตอบทั้งหมดของนักศึกษา</td></tr>
                                            <tr><td><code>time_taken</code></td><td><span class="badge bg-warning">INT</span></td><td>เวลาที่ใช้ทำ (นาที)</td></tr>
                                            <tr><td><code>start_time</code></td><td><span class="badge bg-dark">DATETIME</span></td><td>เวลาเริ่มทำข้อสอบ</td></tr>
                                            <tr><td><code>end_time</code></td><td><span class="badge bg-dark">DATETIME</span></td><td>เวลาส่งข้อสอบ</td></tr>
                                            <tr><td><code>is_completed</code></td><td><span class="badge bg-secondary">BOOLEAN</span></td><td>สถานะการสอบ (เสร็จ/ไม่เสร็จ)</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header bg-dark text-white">
                                    <h6 class="mb-0"><i class="fas fa-sitemap me-2"></i>ความสัมพันธ์ระหว่างตาราง</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="list-unstyled">
                                        <li class="mb-2">
                                            <i class="fas fa-arrow-right text-primary me-2"></i>
                                            <small><code>users(1) → subjects(n)</code><br>อาจารย์ 1 คน สอนได้หลายวิชา</small>
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-arrow-right text-success me-2"></i>
                                            <small><code>subjects(1) → exams(n)</code><br>วิชา 1 วิชา มีได้หลายข้อสอบ</small>
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-arrow-right text-info me-2"></i>
                                            <small><code>exams(1) → questions(n)</code><br>ข้อสอบ 1 ชุด มีหลายคำถาม</small>
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-arrow-right text-warning me-2"></i>
                                            <small><code>users(1) → exam_results(n)</code><br>นักศึกษา 1 คน สอบได้หลายครั้ง</small>
                                        </li>
                                        <li>
                                            <i class="fas fa-arrow-right text-danger me-2"></i>
                                            <small><code>exams(1) → exam_results(n)</code><br>ข้อสอบ 1 ชุด มีหลายผลสอบ</small>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ER Diagram with Mermaid.js -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header bg-gradient" style="background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);">
                                    <h6 class="mb-0 text-white">
                                        <i class="fas fa-project-diagram me-2"></i>
                                        Entity Relationship Diagram (ERD) - แผนภาพความสัมพันธ์ระหว่างตาราง
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info">
                                        <h6><i class="fas fa-info-circle me-2"></i>Database Schema Overview</h6>
                                        <p class="mb-0">แผนภาพแสดงความสัมพันธ์ระหว่างตารางในฐานข้อมูลระบบ PISA พร้อมคำอธิบายฟิลด์สำคัญ</p>
                                    </div>
                                    
                                    <!-- Mermaid ER Diagram -->
                                    <div class="text-center mb-4">
                                        <div id="mermaid-erd" class="border rounded p-3" style="background: #f8f9fa;">
                                            <!-- Mermaid diagram will be rendered here -->
                                        </div>
                                    </div>

                                    <!-- Relationship Explanations -->
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="card bg-light">
                                                <div class="card-header bg-primary text-white">
                                                    <h6 class="mb-0"><i class="fas fa-sitemap me-2"></i>ความสัมพันธ์หลัก (Relationships)</h6>
                                                </div>
                                                <div class="card-body">
                                                    <ul class="list-unstyled">
                                                        <li class="mb-3">
                                                            <i class="fas fa-arrow-right text-primary me-2"></i>
                                                            <strong>Users → Subjects</strong> (1:N)<br>
                                                            <small class="text-muted">อาจารย์ 1 คน สามารถสอนได้หลายวิชา</small>
                                                        </li>
                                                        <li class="mb-3">
                                                            <i class="fas fa-arrow-right text-success me-2"></i>
                                                            <strong>Subjects → Exams</strong> (1:N)<br>
                                                            <small class="text-muted">วิชา 1 วิชา สามารถมีได้หลายข้อสอบ</small>
                                                        </li>
                                                        <li class="mb-3">
                                                            <i class="fas fa-arrow-right text-info me-2"></i>
                                                            <strong>Exams → Questions</strong> (1:N)<br>
                                                            <small class="text-muted">ข้อสอบ 1 ชุด มีหลายคำถาม</small>
                                                        </li>
                                                        <li class="mb-3">
                                                            <i class="fas fa-arrow-right text-warning me-2"></i>
                                                            <strong>Users → Exam Results</strong> (1:N)<br>
                                                            <small class="text-muted">นักศึกษา 1 คน สอบได้หลายครั้ง</small>
                                                        </li>
                                                        <li>
                                                            <i class="fas fa-arrow-right text-danger me-2"></i>
                                                            <strong>Exams → Exam Results</strong> (1:N)<br>
                                                            <small class="text-muted">ข้อสอบ 1 ชุด มีผู้เข้าสอบหลายคน</small>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <div class="card bg-light">
                                                <div class="card-header bg-dark text-white">
                                                    <h6 class="mb-0"><i class="fas fa-key me-2"></i>สัญลักษณ์และคำอธิบาย</h6>
                                                </div>
                                                <div class="card-body">
                                                    <div class="row">
                                                        <div class="col-12 mb-3">
                                                            <h6 class="text-primary">ประเภทฟิลด์:</h6>
                                                            <ul class="list-unstyled small">
                                                                <li><span class="badge bg-warning me-2">PK</span>Primary Key - รหัสหลัก</li>
                                                                <li><span class="badge bg-info me-2">FK</span>Foreign Key - รหัสอ้างอิง</li>
                                                                <li><span class="badge bg-success me-2">UNIQUE</span>ข้อมูลไม่ซ้ำ</li>
                                                                <li><span class="badge bg-secondary me-2">INDEX</span>ดัชนีเพื่อค้นหาเร็ว</li>
                                                            </ul>
                                                        </div>
                                                        <div class="col-12 mb-3">
                                                            <h6 class="text-success">ประเภทข้อมูล:</h6>
                                                            <ul class="list-unstyled small">
                                                                <li><span class="badge bg-primary me-2">INT</span>ตัวเลขจำนวนเต็ม</li>
                                                                <li><span class="badge bg-info me-2">VARCHAR</span>ข้อความจำกัดความยาว</li>
                                                                <li><span class="badge bg-success me-2">TEXT</span>ข้อความยาว</li>
                                                                <li><span class="badge bg-warning me-2">DATETIME</span>วันที่และเวลา</li>
                                                                <li><span class="badge bg-danger me-2">BOOLEAN</span>จริง/เท็จ</li>
                                                                <li><span class="badge bg-dark me-2">JSON</span>ข้อมูล JSON</li>
                                                            </ul>
                                                        </div>
                                                        <div class="col-12">
                                                            <h6 class="text-info">ความสัมพันธ์:</h6>
                                                            <ul class="list-unstyled small">
                                                                <li><span class="badge bg-success me-2">1:1</span>หนึ่งต่อหนึ่ง</li>
                                                                <li><span class="badge bg-warning me-2">1:N</span>หนึ่งต่อหลาย</li>
                                                                <li><span class="badge bg-danger me-2">N:M</span>หลายต่อหลาย</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer bg-light">
                                    <div class="row text-center">
                                        <div class="col-md-3">
                                            <div class="text-primary">
                                                <i class="fas fa-users fa-2x mb-2"></i>
                                                <h6>Users Management</h6>
                                                <small>จัดการผู้ใช้ 3 ประเภท</small>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="text-success">
                                                <i class="fas fa-book fa-2x mb-2"></i>
                                                <h6>Subject & Exam</h6>
                                                <small>จัดการวิชาและข้อสอบ</small>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="text-info">
                                                <i class="fas fa-question-circle fa-2x mb-2"></i>
                                                <h6>Question Bank</h6>
                                                <small>คลังคำถามยืดหยุ่น</small>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="text-warning">
                                                <i class="fas fa-chart-bar fa-2x mb-2"></i>
                                                <h6>Results & Analytics</h6>
                                                <small>ผลสอบและการวิเคราะห์</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Design -->
        <div class="tab-pane fade" id="api-design" role="tabpanel">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-code text-success me-2"></i>
                        API Design
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted mb-4">REST API Endpoints รายละเอียดครบถ้วนพร้อม Request/Response และ Error Codes</p>
                    
                    <!-- Base URL Info -->
                    <div class="alert alert-info mb-4">
                        <h6><i class="fas fa-info-circle me-2"></i>Base Information</h6>
                        <p class="mb-2"><strong>Base URL:</strong> <code>https://localhost:7175</code></p>
                        <p class="mb-2"><strong>Content-Type:</strong> <code>application/json</code></p>
                        <p class="mb-0"><strong>Authentication:</strong> Bearer Token (สำหรับ protected endpoints)</p>
                    </div>

                    <!-- Authentication APIs -->
                    <div class="mb-5">
                        <h6 class="text-primary mb-3"><i class="fas fa-lock me-2"></i>Authentication APIs</h6>
                        
                        <!-- Login API -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-success me-2">POST</span><code>/api/auth/login</code> - เข้าสู่ระบบ</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Request Body:</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "username": "admin01",
  "password": "admin123"
}</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "token": "eyJhbGciOiJIUzI1...",
  "user": {
    "id": 1,
    "username": "admin01",
    "fullName": "ผู้ดูแลระบบ",
    "role": "Admin"
  },
  "expiresAt": "2024-12-15T10:30:00Z"
}</code></pre>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <h6 class="text-danger">Error Responses:</h6>
                                    <ul class="list-unstyled">
                                        <li><span class="badge bg-danger me-2">401</span>Invalid credentials</li>
                                        <li><span class="badge bg-warning me-2">403</span>Account deactivated</li>
                                        <li><span class="badge bg-secondary me-2">400</span>Missing required fields</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Logout API -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-warning me-2">POST</span><code>/api/auth/logout</code> - ออกจากระบบ</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Headers:</h6>
                                        <pre class="bg-light p-2 rounded"><code>Authorization: Bearer {token}</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "message": "Logged out successfully"
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Change Password API -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-info me-2">PUT</span><code>/api/auth/change-password</code> - เปลี่ยนรหัสผ่าน</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Request Body:</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "currentPassword": "oldpass123",
  "newPassword": "newpass456",
  "confirmPassword": "newpass456"
}</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "message": "Password updated successfully"
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Users Management APIs -->
                    <div class="mb-5">
                        <h6 class="text-success mb-3"><i class="fas fa-users me-2"></i>Users Management APIs</h6>
                        
                        <!-- Get All Users -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-primary me-2">GET</span><code>/api/users</code> - ดึงรายการผู้ใช้ทั้งหมด</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Query Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>page=1              (int, default: 1)
pageSize=10         (int, default: 10)
role=Admin          (enum: Admin/Teacher/Student)
search=john         (string, search in name/email)
isActive=true       (boolean)
sortBy=createdDate  (string)
sortOrder=desc      (string: asc/desc)</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "data": {
    "users": [...],
    "pagination": {
      "currentPage": 1,
      "totalPages": 15,
      "totalItems": 150,
      "pageSize": 10
    }
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Get User by ID -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-primary me-2">GET</span><code>/api/users/{id}</code> - ดึงข้อมูลผู้ใช้รายคน</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Path Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>id: number (required)</code></pre>
                                        <h6 class="text-success mt-3">Example:</h6>
                                        <pre class="bg-light p-2 rounded"><code>GET /api/users/123</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "data": {
    "id": 123,
    "username": "student001",
    "fullName": "นางสาววิมลรัตน์ ใจดี",
    "email": "student1@student.pisa.edu",
    "phoneNumber": "09-201-3001",
    "role": "Student",
    "isActive": true,
    "createdDate": "2024-01-15T08:30:00Z",
    "lastLoginDate": "2024-12-14T14:22:00Z"
  }
}</code></pre>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <h6 class="text-danger">Error Responses:</h6>
                                    <ul class="list-unstyled">
                                        <li><span class="badge bg-danger me-2">404</span>User not found</li>
                                        <li><span class="badge bg-warning me-2">403</span>Insufficient permissions</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Create User -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-success me-2">POST</span><code>/api/users</code> - สร้างผู้ใช้ใหม่</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Request Body:</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "username": "newuser001",
  "password": "password123",
  "fullName": "นายสมชาย ใหม่",
  "email": "newuser@example.com",
  "phoneNumber": "08-123-4567",
  "role": "Student"
}</code></pre>
                                        <small class="text-muted">*All fields required</small>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (201):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "message": "User created successfully",
  "data": {
    "id": 151,
    "username": "newuser001",
    "fullName": "นายสมชาย ใหม่",
    "role": "Student",
    "isActive": true,
    "createdDate": "2024-12-14T16:30:00Z"
  }
}</code></pre>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <h6 class="text-danger">Validation Rules:</h6>
                                    <ul class="list-unstyled">
                                        <li><span class="badge bg-info me-2">Username</span>3-50 characters, alphanumeric only</li>
                                        <li><span class="badge bg-info me-2">Password</span>Minimum 6 characters</li>
                                        <li><span class="badge bg-info me-2">Email</span>Valid email format</li>
                                        <li><span class="badge bg-info me-2">Role</span>Admin, Teacher, or Student</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Update User -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-info me-2">PUT</span><code>/api/users/{id}</code> - แก้ไขข้อมูลผู้ใช้</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Request Body (partial update):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "fullName": "นายสมชาย แก้ไขแล้ว",
  "email": "updated@example.com",
  "phoneNumber": "08-999-8888",
  "isActive": false
}</code></pre>
                                        <small class="text-muted">*Send only fields to update</small>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "message": "User updated successfully",
  "data": {
    "id": 151,
    "fullName": "นายสมชาย แก้ไขแล้ว",
    "email": "updated@example.com",
    "phoneNumber": "08-999-8888",
    "isActive": false,
    "updatedDate": "2024-12-14T17:15:00Z"
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Delete User -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-danger me-2">DELETE</span><code>/api/users/{id}</code> - ลบผู้ใช้</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Path Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>id: number (required)</code></pre>
                                        <div class="alert alert-warning mt-2">
                                            <small><i class="fas fa-exclamation-triangle me-1"></i>การลบจะเป็น Soft Delete (isActive = false)</small>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "message": "User deleted successfully"
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Subjects Management APIs -->
                    <div class="mb-5">
                        <h6 class="text-info mb-3"><i class="fas fa-book me-2"></i>Subjects Management APIs</h6>
                        
                        <!-- Get All Subjects -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-primary me-2">GET</span><code>/api/subjects</code> - ดึงรายการวิชาทั้งหมด</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Query Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>teacherId=6      (int, filter by teacher)
isActive=true    (boolean)
search=math      (string, search in name/code)
page=1           (int)
pageSize=20      (int)</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "data": {
    "subjects": [
      {
        "id": 1,
        "name": "คณิตศาสตร์พื้นฐาน",
        "code": "MATH101",
        "description": "รายวิชาคณิตศาสตร์...",
        "teacherId": 6,
        "teacherName": "อาจารย์สมชาย",
        "examCount": 4,
        "studentCount": 35,
        "isActive": true,
        "createdDate": "2024-01-10T09:00:00Z"
      }
    ],
    "pagination": {...}
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Create Subject -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-success me-2">POST</span><code>/api/subjects</code> - สร้างวิชาใหม่</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Request Body:</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "name": "ฟิสิกส์ขั้นสูง",
  "code": "PHYS201",
  "description": "วิชาฟิสิกส์สำหรับนักศึกษาระดับสูง",
  "teacherId": 8
}</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (201):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "message": "Subject created successfully",
  "data": {
    "id": 51,
    "name": "ฟิสิกส์ขั้นสูง",
    "code": "PHYS201",
    "teacherId": 8,
    "isActive": true,
    "createdDate": "2024-12-14T18:00:00Z"
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Exams Management APIs -->
                    <div class="mb-5">
                        <h6 class="text-warning mb-3"><i class="fas fa-file-alt me-2"></i>Exams Management APIs</h6>
                        
                        <!-- Get All Exams -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-primary me-2">GET</span><code>/api/exams</code> - ดึงรายการข้อสอบทั้งหมด</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Query Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>subjectId=1      (int, filter by subject)
teacherId=6      (int, filter by teacher)
isActive=true    (boolean)
status=active    (string: active/upcoming/past)
search=midterm   (string)
page=1           (int)
pageSize=15      (int)</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "data": {
    "exams": [
      {
        "id": 1,
        "title": "สอบกลางภาค คณิตศาสตร์พื้นฐาน ครั้งที่ 1",
        "subjectId": 1,
        "subjectName": "คณิตศาสตร์พื้นฐาน",
        "duration": 120,
        "totalPoints": 100,
        "questionCount": 20,
        "participantCount": 35,
        "startDate": "2024-12-20T09:00:00Z",
        "endDate": "2024-12-25T17:00:00Z",
        "status": "upcoming",
        "isActive": true
      }
    ],
    "pagination": {...}
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Create Exam -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-success me-2">POST</span><code>/api/exams</code> - สร้างข้อสอบใหม่</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Request Body:</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "title": "แบบทดสอบ Unit 1",
  "description": "ทดสอบความรู้ในหน่วยที่ 1",
  "subjectId": 1,
  "duration": 60,
  "totalPoints": 50,
  "startDate": "2024-12-20T14:00:00Z",
  "endDate": "2024-12-22T17:00:00Z",
  "questions": [
    {
      "text": "2 + 2 เท่ากับเท่าใด?",
      "type": "MultipleChoice",
      "options": ["3", "4", "5", "6"],
      "correctAnswer": "4",
      "points": 5
    }
  ]
}</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (201):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "message": "Exam created successfully",
  "data": {
    "id": 201,
    "title": "แบบทดสอบ Unit 1",
    "subjectId": 1,
    "duration": 60,
    "totalPoints": 50,
    "questionCount": 1,
    "isActive": true,
    "createdDate": "2024-12-14T19:00:00Z"
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Get Exam Questions -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-primary me-2">GET</span><code>/api/exams/{id}/questions</code> - ดึงคำถามของข้อสอบ</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Path Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>id: number (exam ID)</code></pre>
                                        <div class="alert alert-info mt-2">
                                            <small><i class="fas fa-info-circle me-1"></i>สำหรับนักศึกษา: จะไม่แสดง correctAnswer</small>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "data": {
    "examId": 1,
    "examTitle": "สอบกลางภาค คณิตศาสตร์",
    "duration": 120,
    "totalPoints": 100,
    "questions": [
      {
        "id": 1001,
        "text": "2 + 2 เท่ากับเท่าใด?",
        "type": "MultipleChoice",
        "options": ["3", "4", "5", "6"],
        "points": 5
      }
    ]
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Submit Exam -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-success me-2">POST</span><code>/api/exams/{id}/submit</code> - ส่งคำตอบข้อสอบ</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Request Body:</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "examId": 1,
  "studentId": 31,
  "startTime": "2024-12-20T14:00:00Z",
  "endTime": "2024-12-20T15:30:00Z",
  "answers": [
    {
      "questionId": 1001,
      "answer": "4"
    },
    {
      "questionId": 1002,
      "answer": "คำตอบข้อ 2"
    }
  ]
}</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "message": "Exam submitted successfully",
  "data": {
    "resultId": 501,
    "score": 85,
    "totalPoints": 100,
    "percentage": 85.0,
    "timeTaken": "01:30:00",
    "isCompleted": true,
    "submittedAt": "2024-12-20T15:30:00Z",
    "correctAnswers": 17,
    "totalQuestions": 20
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reports & Analytics APIs -->
                    <div class="mb-5">
                        <h6 class="text-danger mb-3"><i class="fas fa-chart-line me-2"></i>Reports & Analytics APIs</h6>
                        
                        <!-- Get Student Results -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-primary me-2">GET</span><code>/api/students/{id}/results</code> - ดึงผลการสอบของนักศึกษา</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Query Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>subjectId=1      (int, filter by subject)
dateFrom=2024-01-01  (date)
dateTo=2024-12-31    (date)
page=1           (int)
pageSize=10      (int)</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "data": {
    "studentInfo": {
      "id": 31,
      "fullName": "นางสาววิมลรัตน์ ใจดี",
      "studentId": "64010001"
    },
    "results": [...],
    "summary": {
      "totalExams": 8,
      "averageScore": 78.5,
      "highestScore": 95,
      "lowestScore": 62,
      "passedExams": 7
    },
    "pagination": {...}
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Get Reports Summary -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-primary me-2">GET</span><code>/api/reports/summary</code> - ดึงรายงานสรุปภาพรวม</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Query Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>dateFrom=2024-01-01  (date)
dateTo=2024-12-31    (date)
subjectId=1      (int, optional)
teacherId=6      (int, optional)</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response (200):</h6>
                                        <pre class="bg-light p-2 rounded"><code>{
  "success": true,
  "data": {
    "totalStudents": 120,
    "totalExams": 200,
    "totalSubjects": 50,
    "totalResults": 520,
    "averageScore": 76.8,
    "passRate": 85.4,
    "topPerformers": [...],
    "subjectPerformance": [...],
    "examTrends": [...]
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Export Data -->
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0"><span class="badge bg-primary me-2">GET</span><code>/api/exports/{format}</code> - ส่งออกข้อมูล</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success">Path Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>format: string (csv|pdf|excel)</code></pre>
                                        <h6 class="text-success mt-3">Query Parameters:</h6>
                                        <pre class="bg-light p-2 rounded"><code>type=results     (string: users|subjects|exams|results)
subjectId=1      (int, optional)
dateFrom=2024-01-01  (date)
dateTo=2024-12-31    (date)</code></pre>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-primary">Response:</h6>
                                        <pre class="bg-light p-2 rounded"><code>Content-Type: application/octet-stream
Content-Disposition: attachment; filename="report.csv"

[Binary file content]</code></pre>
                                        <div class="alert alert-success mt-2">
                                            <small><i class="fas fa-download me-1"></i>ไฟล์จะถูกดาวน์โหลดโดยอัตโนมัติ</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Error Codes Reference -->
                    <div class="card">
                        <div class="card-header bg-dark text-white">
                            <h6 class="mb-0"><i class="fas fa-exclamation-triangle me-2"></i>HTTP Status Codes Reference</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-success">Success Codes:</h6>
                                    <ul class="list-unstyled">
                                        <li><span class="badge bg-success me-2">200</span>OK - Request successful</li>
                                        <li><span class="badge bg-success me-2">201</span>Created - Resource created</li>
                                        <li><span class="badge bg-info me-2">204</span>No Content - Successful, no data returned</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-danger">Error Codes:</h6>
                                    <ul class="list-unstyled">
                                        <li><span class="badge bg-warning me-2">400</span>Bad Request - Invalid input</li>
                                        <li><span class="badge bg-danger me-2">401</span>Unauthorized - Authentication required</li>
                                        <li><span class="badge bg-warning me-2">403</span>Forbidden - Insufficient permissions</li>
                                        <li><span class="badge bg-danger me-2">404</span>Not Found - Resource not found</li>
                                        <li><span class="badge bg-danger me-2">409</span>Conflict - Duplicate data</li>
                                        <li><span class="badge bg-secondary me-2">500</span>Internal Server Error</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Project Structure -->
        <div class="tab-pane fade" id="project-structure" role="tabpanel">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-folder-tree text-warning me-2"></i>
                        Project Structure
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted mb-4">การจัดระเบียบไฟล์และโฟลเดอร์ในโปรเจค PISA Exam System</p>
                    
                    <div class="row">
                        <div class="col-md-8">
                            <div class="bg-dark text-light p-3 rounded">
                                <pre class="mb-0" style="color: #e6e6e6; font-family: 'Courier New', monospace;">
<span style="color: #ffd700;">PISA_APP/</span>
├── <span style="color: #87ceeb;">Components/</span>
│   ├── <span style="color: #90ee90;">Layout/</span>                    <span style="color: #888;">// Header, Sidebar, Footer</span>
│   │   ├── MainLayout.razor
│   │   ├── MainLayout.razor.css
│   │   ├── NavMenu.razor
│   │   └── NavMenu.razor.css
│   ├── <span style="color: #90ee90;">Pages/</span>                     <span style="color: #888;">// หน้าต่างๆ ของระบบ</span>
│   │   ├── <span style="color: #ffb347;">Auth/</span>                  <span style="color: #888;">// การ Authentication</span>
│   │   │   ├── Login.razor
│   │   │   ├── ChangePassword.razor
│   │   │   ├── Error.razor
│   │   │   ├── NotFound.razor
│   │   │   └── Unauthorized.razor
│   │   ├── <span style="color: #ffb347;">UserManagement/</span>        <span style="color: #888;">// จัดการผู้ใช้</span>
│   │   │   ├── ManageAdmins.razor
│   │   │   ├── ManageTeachers.razor
│   │   │   ├── ManageStudents.razor
│   │   │   └── ManageRoles.razor
│   │   ├── <span style="color: #ffb347;">ContentManagement/</span>     <span style="color: #888;">// จัดการเนื้อหา</span>
│   │   │   ├── ManageSubjects.razor
│   │   │   └── ExamParticipants.razor
│   │   ├── <span style="color: #ffb347;">Student/</span>               <span style="color: #888;">// ส่วนของนักศึกษา</span>
│   │   │   ├── TakeExam.razor
│   │   │   ├── ExamResults.razor
│   │   │   └── Subjects.razor
│   │   ├── Dashboard.razor          <span style="color: #888;">// หน้าแดชบอร์ด</span>
│   │   ├── Reports.razor            <span style="color: #888;">// รายงานและสถิติ</span>
│   │   ├── Documentation.razor      <span style="color: #888;">// เอกสารประกอบ</span>
│   │   ├── Profile.razor            <span style="color: #888;">// โปรไฟล์ผู้ใช้</span>
│   │   └── Counter.razor            <span style="color: #888;">// หน้าตัวอย่าง</span>
│   ├── <span style="color: #90ee90;">Shared/</span>                    <span style="color: #888;">// Components ที่ใช้ร่วมกัน</span>
│   │   └── PaginatedTable.razor     <span style="color: #888;">// ตารางแบบ Pagination</span>
│   ├── Routes.razor                 <span style="color: #888;">// การจัดการ Routing</span>
│   ├── App.razor                    <span style="color: #888;">// Layout หลักของแอป</span>
│   └── _Imports.razor               <span style="color: #888;">// Import namespaces</span>
├── <span style="color: #87ceeb;">Models/</span>                        <span style="color: #888;">// Data Models</span>
│   ├── User.cs                      <span style="color: #888;">// Admin, Teacher, Student</span>
│   ├── Subject.cs                   <span style="color: #888;">// วิชาเรียน</span>
│   ├── Exam.cs                      <span style="color: #888;">// ข้อสอบ</span>
│   ├── ExamResult.cs                <span style="color: #888;">// ผลการสอบ</span>
│   └── PaginationModel.cs           <span style="color: #888;">// สำหรับ Pagination</span>
├── <span style="color: #87ceeb;">Services/</span>                      <span style="color: #888;">// Business Logic</span>
│   ├── AuthenticationService.cs     <span style="color: #888;">// จัดการ Login/Logout</span>
│   └── MockDataService.cs           <span style="color: #888;">// ข้อมูลจำลอง</span>
├── <span style="color: #87ceeb;">wwwroot/</span>                       <span style="color: #888;">// Static Files</span>
│   ├── <span style="color: #90ee90;">bootstrap/</span>                 <span style="color: #888;">// Bootstrap CSS</span>
│   │   ├── bootstrap.min.css
│   │   └── bootstrap.min.css.map
│   ├── app.css                      <span style="color: #888;">// Custom CSS</span>
│   └── favicon.png                  <span style="color: #888;">// ไอคอนเว็บไซต์</span>
├── <span style="color: #87ceeb;">Properties/</span>                    <span style="color: #888;">// การตั้งค่าโปรเจค</span>
│   └── launchSettings.json          <span style="color: #888;">// การตั้งค่า Development</span>
├── Program.cs                       <span style="color: #888;">// Entry Point</span>
├── appsettings.json                 <span style="color: #888;">// การตั้งค่าแอป</span>
├── appsettings.Development.json     <span style="color: #888;">// การตั้งค่า Dev</span>
├── PISA_APP.csproj                  <span style="color: #888;">// โปรเจคไฟล์</span>
└── PISA_APP.sln                     <span style="color: #888;">// Solution ไฟล์</span>
                                </pre>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0"><i class="fas fa-layer-group me-2"></i>Architecture Layers</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <h6 class="text-primary">Presentation Layer</h6>
                                        <ul class="list-unstyled ps-3">
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>Razor Components</li>
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>CSS Styling</li>
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>JavaScript Integration</li>
                                        </ul>
                                    </div>
                                    <div class="mb-3">
                                        <h6 class="text-success">Business Layer</h6>
                                        <ul class="list-unstyled ps-3">
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>Services</li>
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>Authentication</li>
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>Data Processing</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h6 class="text-warning">Data Layer</h6>
                                        <ul class="list-unstyled ps-3">
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>Models</li>
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>Mock Data Service</li>
                                            <li><i class="fas fa-chevron-right text-muted me-2"></i>Data Validation</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mt-3">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0"><i class="fas fa-tools me-2"></i>Technologies Used</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-12">
                                            <span class="badge bg-primary me-1 mb-1">Blazor Server</span>
                                            <span class="badge bg-info me-1 mb-1">C# .NET 8</span>
                                            <span class="badge bg-success me-1 mb-1">Bootstrap 5</span>
                                            <span class="badge bg-warning me-1 mb-1">FontAwesome</span>
                                            <span class="badge bg-danger me-1 mb-1">SignalR</span>
                                            <span class="badge bg-dark me-1 mb-1">Razor Pages</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Guide -->
        <div class="tab-pane fade" id="user-guide" role="tabpanel">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-question-circle text-info me-2"></i>
                        User Guide
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted mb-4">คู่มือการใช้งานระบบข้อสอบออนไลน์ PISA สำหรับผู้ใช้แต่ละประเภท</p>
                    
                    <!-- Admin Guide -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="mb-0"><i class="fas fa-user-shield me-2"></i>Admin Guide</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="ps-3">
                                        <li class="mb-2">เข้าสู่ระบบด้วยบัญชี Admin</li>
                                        <li class="mb-2">จัดการผู้ใช้ทั้งหมด (Admin, Teacher, Student)</li>
                                        <li class="mb-2">ดูรายงานและสถิติการใช้งาน</li>
                                        <li class="mb-2">ส่งออกข้อมูลเป็น CSV/PDF</li>
                                        <li class="mb-2">ตั้งค่าระบบและสิทธิ์การเข้าถึง</li>
                                        <li>ดูเอกสารประกอบระบบ</li>
                                    </ol>
                                    <div class="alert alert-info">
                                        <small><i class="fas fa-info-circle me-1"></i>Admin มีสิทธิ์เข้าถึงทุกส่วนของระบบ</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0"><i class="fas fa-chalkboard-teacher me-2"></i>Teacher Guide</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="ps-3">
                                        <li class="mb-2">เข้าสู่ระบบด้วยบัญชี Teacher</li>
                                        <li class="mb-2">จัดการวิชาที่สอน</li>
                                        <li class="mb-2">สร้างและแก้ไขข้อสอบ</li>
                                        <li class="mb-2">ดูผลการสอบของนักศึกษา</li>
                                        <li class="mb-2">จัดการผู้เข้าสอบ</li>
                                        <li>ส่งออกรายงานผลการสอบ</li>
                                    </ol>
                                    <div class="alert alert-warning">
                                        <small><i class="fas fa-exclamation-triangle me-1"></i>Teacher เข้าถึงได้เฉพาะวิชาที่ตนสอน</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0"><i class="fas fa-user-graduate me-2"></i>Student Guide</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="ps-3">
                                        <li class="mb-2">เข้าสู่ระบบด้วยบัญชี Student</li>
                                        <li class="mb-2">ดูวิชาที่ลงทะเบียนไว้</li>
                                        <li class="mb-2">เข้าสู่การสอบตามเวลาที่กำหนด</li>
                                        <li class="mb-2">ทำข้อสอบภายในเวลาที่กำหนด</li>
                                        <li class="mb-2">ดูผลการสอบของตนเอง</li>
                                        <li>แก้ไขโปรไฟล์ส่วนตัว</li>
                                    </ol>
                                    <div class="alert alert-primary">
                                        <small><i class="fas fa-clock me-1"></i>Student ต้องทำข้อสอบตามเวลาที่กำหนด</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Feature Overview -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-dark text-white">
                                    <h6 class="mb-0"><i class="fas fa-star me-2"></i>Key Features</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-6">
                                            <ul class="list-unstyled">
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>User Management</li>
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Subject Management</li>
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Exam Creation</li>
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Online Testing</li>
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Auto Grading</li>
                                            </ul>
                                        </div>
                                        <div class="col-6">
                                            <ul class="list-unstyled">
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Reports & Analytics</li>
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Data Export</li>
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Responsive Design</li>
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Real-time Updates</li>
                                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Security Controls</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-secondary text-white">
                                    <h6 class="mb-0"><i class="fas fa-lightbulb me-2"></i>Tips & Best Practices</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="list-unstyled">
                                        <li class="mb-2">
                                            <i class="fas fa-shield-alt text-primary me-2"></i>
                                            <strong>Security:</strong> เปลี่ยนรหัสผ่านเริ่มต้นทันที
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-clock text-warning me-2"></i>
                                            <strong>Timing:</strong> ตั้งเวลาสอบให้เหมาะสมกับจำนวนข้อ
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-save text-success me-2"></i>
                                            <strong>Backup:</strong> สำรองข้อมูลข้อสอบเป็นประจำ
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-chart-bar text-info me-2"></i>
                                            <strong>Monitoring:</strong> ติดตามการใช้งานผ่านรายงาน
                                        </li>
                                        <li>
                                            <i class="fas fa-users text-danger me-2"></i>
                                            <strong>Training:</strong> อบรมผู้ใช้ก่อนใช้งานจริง
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private async Task ExportDocumentation()
    {
        try
        {
            var documentationContent = GenerateDocumentationContent();
            await JSRuntime.InvokeVoidAsync("downloadFile", "PISA_Documentation.html", documentationContent, "text/html");
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("alert", "เกิดข้อผิดพลาดในการ Export เอกสาร");
        }
    }

    private string GenerateDocumentationContent()
    {
        return $@"
<!DOCTYPE html>
<html>
<head>
    <title>PISA Exam System Documentation</title>
    <style>
        body {{ font-family: Arial, sans-serif; margin: 40px; }}
        h1 {{ color: #2c3e50; }}
        h2 {{ color: #34495e; border-bottom: 2px solid #3498db; }}
        .table {{ width: 100%; border-collapse: collapse; margin: 20px 0; }}
        .table th, .table td {{ border: 1px solid #ddd; padding: 8px; text-align: left; }}
        .table th {{ background-color: #f2f2f2; }}
        .code {{ background-color: #f8f9fa; padding: 2px 4px; border-radius: 3px; font-family: monospace; }}
    </style>
</head>
<body>
    <h1>PISA Exam System Documentation</h1>
    <p>Generated on: {DateTime.Now:yyyy-MM-dd HH:mm:ss}</p>
    
    <h2>Database Schema</h2>
    <p>โครงสร้างฐานข้อมูลระบบข้อสอบออนไลน์ PISA</p>
    
    <h2>API Endpoints</h2>
    <p>REST API สำหรับการเชื่อมต่อและจัดการข้อมูล</p>
    
    <h2>Project Structure</h2>
    <p>การจัดระเบียบไฟล์และโฟลเดอร์ในโปรเจค</p>
    
    <h2>User Guide</h2>
    <p>คู่มือการใช้งานสำหรับผู้ใช้แต่ละประเภท</p>
</body>
</html>";
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JSRuntime.InvokeVoidAsync("initializeDocTabs");
        }
    }
}

<script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

<script>
    window.initializeDocTabs = function() {
        try {
            var triggerTabList = [].slice.call(document.querySelectorAll('#docTabs button[data-bs-toggle="tab"]'));
            
            triggerTabList.forEach(function (triggerEl) {
                if (typeof bootstrap !== 'undefined' && bootstrap.Tab) {
                    var tabTrigger = new bootstrap.Tab(triggerEl);
                    
                    triggerEl.addEventListener('click', function (event) {
                        event.preventDefault();
                        tabTrigger.show();
                        
                        // Initialize Mermaid when Database Schema tab is clicked
                        if (triggerEl.getAttribute('data-bs-target') === '#database-design') {
                            setTimeout(function() {
                                initializeMermaidERD();
                            }, 100);
                        }
                    });
                }
            });

            // Initialize Mermaid on page load if Database Schema tab is active
            setTimeout(function() {
                initializeMermaidERD();
            }, 500);
            
        } catch (error) {
            console.error('Error initializing documentation tabs:', error);
        }
    };

    window.initializeMermaidERD = function() {
        try {
            if (typeof mermaid === 'undefined') {
                console.log('Mermaid not loaded yet, retrying...');
                setTimeout(initializeMermaidERD, 500);
                return;
            }

            // Configure Mermaid
            mermaid.initialize({
                startOnLoad: false,
                theme: 'default',
                themeVariables: {
                    primaryColor: '#667eea',
                    primaryTextColor: '#333',
                    primaryBorderColor: '#764ba2',
                    lineColor: '#764ba2',
                    secondaryColor: '#f8f9fa',
                    tertiaryColor: '#e9ecef'
                },
                er: {
                    diagramPadding: 20,
                    layoutDirection: 'TB',
                    minEntityWidth: 100,
                    minEntityHeight: 75,
                    entityPadding: 15,
                    stroke: '#333333',
                    fill: '#ECECFF',
                    fontSize: 12
                }
            });

            // Define the ER Diagram
            const erdDefinition = `
                erDiagram
                    USERS {
                        int id PK "รหัสผู้ใช้"
                        string username UK "ชื่อผู้ใช้"
                        string password "รหัสผ่าน(Hash)"
                        string full_name "ชื่อ-นามสกุล"
                        string email UK "อีเมล"
                        string phone "เบอร์โทร"
                        enum role "บทบาท"
                        boolean is_active "สถานะใช้งาน"
                        datetime created_at "วันที่สร้าง"
                    }
                    
                    SUBJECTS {
                        int id PK "รหัสวิชา"
                        string name "ชื่อวิชา"
                        string code UK "รหัสวิชา"
                        text description "คำอธิบาย"
                        int teacher_id FK "รหัสอาจารย์"
                        boolean is_active "สถานะเปิดสอน"
                        datetime created_at "วันที่สร้าง"
                    }
                    
                    EXAMS {
                        int id PK "รหัสข้อสอบ"
                        string title "ชื่อข้อสอบ"
                        text description "คำอธิบาย"
                        int subject_id FK "รหัสวิชา"
                        int time_limit "เวลาทำ(นาที)"
                        int total_points "คะแนนเต็ม"
                        datetime start_date "วันเริ่มสอบ"
                        datetime end_date "วันปิดสอบ"
                        boolean is_active "สถานะใช้งาน"
                        datetime created_at "วันที่สร้าง"
                    }
                    
                    QUESTIONS {
                        int id PK "รหัสคำถาม"
                        int exam_id FK "รหัสข้อสอบ"
                        text question_text "ข้อความคำถาม"
                        enum question_type "ประเภทคำถาม"
                        json options "ตัวเลือก"
                        text correct_answer "คำตอบถูกต้อง"
                        int points "คะแนน"
                    }
                    
                    EXAM_RESULTS {
                        int id PK "รหัสผลสอบ"
                        int student_id FK "รหัสนักศึกษา"
                        int exam_id FK "รหัสข้อสอบ"
                        int score "คะแนนที่ได้"
                        int total_points "คะแนนเต็ม"
                        decimal percentage "เปอร์เซ็นต์"
                        json answers "คำตอบ"
                        int time_taken "เวลาที่ใช้"
                        datetime start_time "เวลาเริ่ม"
                        datetime end_time "เวลาสิ้นสุด"
                        boolean is_completed "สถานะสอบ"
                    }

                    %% Relationships
                    USERS ||--o{ SUBJECTS : "teaches"
                    SUBJECTS ||--o{ EXAMS : "contains"
                    EXAMS ||--o{ QUESTIONS : "has"
                    USERS ||--o{ EXAM_RESULTS : "takes"
                    EXAMS ||--o{ EXAM_RESULTS : "generates"
            `;

            // Clear previous diagram
            const container = document.getElementById('mermaid-erd');
            if (container) {
                container.innerHTML = '';
                
                // Render the diagram
                mermaid.render('erd-diagram', erdDefinition).then(function(result) {
                    container.innerHTML = result.svg;
                    
                    // Add some custom styling
                    const svg = container.querySelector('svg');
                    if (svg) {
                        svg.style.width = '100%';
                        svg.style.height = 'auto';
                        svg.style.maxHeight = '800px';
                    }
                }).catch(function(error) {
                    console.error('Error rendering Mermaid diagram:', error);
                    container.innerHTML = `
                        <div class="alert alert-warning">
                            <h6><i class="fas fa-exclamation-triangle me-2"></i>Unable to load ER Diagram</h6>
                            <p class="mb-0">กำลังโหลด Mermaid.js... หากยังไม่แสดงผล กรุณารีเฟรชหน้าเว็บ</p>
                        </div>
                    `;
                });
            }
        } catch (error) {
            console.error('Error initializing Mermaid ERD:', error);
            const container = document.getElementById('mermaid-erd');
            if (container) {
                container.innerHTML = `
                    <div class="alert alert-danger">
                        <h6><i class="fas fa-times-circle me-2"></i>Error Loading Diagram</h6>
                        <p class="mb-0">ไม่สามารถโหลด ER Diagram ได้ กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต</p>
                    </div>
                `;
            }
        }
    };
</script>